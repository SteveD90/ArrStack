version: "3.2"

services:
  bazarr:
    image: ${BAZARR_IMAGE:-ghcr.io/hotio/bazarr:latest}
    container_name: bazarr
    hostname: bazarr.internal
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${BAZARR_CONFIG}:/config
      - ${MEDIA_PATH}:/media
    ports:
      - "${BAZARR_PORT}:6767"
    restart: unless-stopped
    logging:
      driver: json-file
    networks:
      - arr-network
      
  radarr:
    image: ${RADARR_IMAGE:-ghcr.io/hotio/radarr:latest}
    container_name: radarr
    hostname: radarr.internal
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${RADARR_CONFIG}:/config
      - ${DATA_PATH}:/data
      - ${USENET_PATH}:/usenet
      - ${MEDIA_PATH}:/media
    ports:
      - "${RADARR_PORT}:7878"
    restart: unless-stopped
    logging:
      driver: json-file
    networks:
      - arr-network

  prowlarr:
    image: ${PROWLARR_IMAGE:-ghcr.io/hotio/prowlarr:latest}
    container_name: prowlarr
    hostname: prowlarr.internal
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${PROWLARR_CONFIG}:/config
    ports:
      - "${PROWLARR_PORT}:9696"
    restart: unless-stopped
    logging:
      driver: json-file
    networks:
      - arr-network

  sonarr:
    image: ${SONARR_IMAGE:-ghcr.io/hotio/sonarr:latest}
    container_name: sonarr
    hostname: sonarr.internal
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${SONARR_CONFIG}:/config
      - ${DATA_PATH}:/data
      - ${USENET_PATH}:/usenet
      - ${MEDIA_PATH}:/media
    ports:
      - "${SONARR_PORT}:8989"
    restart: unless-stopped
    logging:
      driver: json-file
    networks:
      - arr-network

  profilarr:
    image: ${PROFILARR_IMAGE:-santiagosayshey/profilarr:latest}
    container_name: profilarr
    hostname: profilarr.internal
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${PROFILARR_CONFIG}:/config
    ports:
      - "${PROFILARR_PORT}:6868"
    restart: unless-stopped
    logging:
      driver: json-file
    networks:
      - arr-network

  sabnzbd:
    image: ${SABNZBD_IMAGE:-ghcr.io/hotio/sabnzbd:latest}
    container_name: sabnzbd
    hostname: sabnzbd.internal
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${SABNZBD_CONFIG}:/config
      - ${USENET_PATH}:/usenet
    ports:
      - "${SABNZBD_PORT}:8080"
      - "${SABNZBD_PORT_HTTPS:-9090}:9090"
    restart: unless-stopped
    logging:
      driver: json-file
    networks:
      - arr-network

  portainer:
    image: ${PORTAINER_IMAGE:-portainer/portainer-ce:latest}
    container_name: portainer
    hostname: portainer.internal
    command: -H unix:///var/run/docker.sock
    restart: unless-stopped
    logging:
      driver: json-file
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ${PORTAINER_DATA:-/mnt/ssd/appdata/portainer}:/data
    ports:
      - "${PORTAINER_PORT:-9000}:9000"
      - "${PORTAINER_HTTPS_PORT:-9443}:9443"
    networks:
      - arr-network

  dockge:
    image: ${DOCKGE_IMAGE:-louislam/dockge:latest}
    container_name: dockge
    hostname: dockge.internal
    restart: unless-stopped
    logging:
      driver: json-file
    environment:
      - DOCKGE_STACKS_DIR=${DOCKGE_STACKS_DIR:-/mnt/ssd/docker/stacks}
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ${DOCKGE_DATA:-/mnt/ssd/appdata/dockge}:/app/data
      - ${DOCKGE_STACKS_DIR:-/mnt/ssd/docker/stacks}:/opt/stacks
    ports:
      - "${DOCKGE_PORT:-5001}:5001"
    networks:
      - arr-network

  media-ai-assistant:
    image: ${MEDIA_AI_IMAGE:-sdonnelly1990/media-ai-assistant:latest}
    container_name: media-ai-assistant
    hostname: media-ai-assistant.internal
    restart: unless-stopped
    logging:
      driver: json-file
    extra_hosts:
      - "nas:${NAS_IP:-10.0.0.8}"
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - OPENAI_MODEL_NAME=${OPENAI_MODEL_NAME:-gpt-4.1-mini}
      - SONARR_URL=${SONARR_URL:-http://sonarr:8989}
      - SONARR_API_KEY=${SONARR_API_KEY}
      - RADARR_URL=${RADARR_URL:-http://radarr:7878}
      - RADARR_API_KEY=${RADARR_API_KEY}
      - SONARR_ROOT_FOLDER=${SONARR_ROOT_FOLDER:-/media/tv}
      - SONARR_QUALITY_PROFILE_ID=${SONARR_QUALITY_PROFILE_ID:-7}
      - SONARR_LANGUAGE_PROFILE_ID=${SONARR_LANGUAGE_PROFILE_ID:-7}
      - RADARR_ROOT_FOLDER=${RADARR_ROOT_FOLDER:-/media/movies}
      - RADARR_QUALITY_PROFILE_ID=${RADARR_QUALITY_PROFILE_ID:-7}
      - LIBRARY_SAMPLE_SIZE=${LIBRARY_SAMPLE_SIZE:-50}
      - FLASK_SECRET_KEY=${FLASK_SECRET_KEY}
    ports:
      - "${MEDIA_AI_PORT:-5050}:5050"
    networks:
      - arr-network
    depends_on:
      - sonarr
      - radarr

networks:
  arr-network:
    driver: bridge